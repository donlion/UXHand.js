"use strict";var UXHand=new function(){this._synchronize=function(callback){var localData=JSON.parse(localStorage.getItem("UXHandData"));null==this._data.scores.left&&null==this._data.scores.right&&null==this._data.scores.both&&localData?this._data=localData:localStorage.setItem("UXHandData",JSON.stringify(this._data)),callback&&callback()},this.compatibility=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},this.touchTest=function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}},this.options=function(){var userOptions=window.UXHandOptions;var output={certainty:.2,cycleDelay:2e4,destroyClasses:!0,destroyData:!0,root:document.body,threshold:50};if(userOptions)try{for(var key in userOptions)output[key]=userOptions[key]}catch(e){}return output},this.cycle=function(){try{this._calc()}catch(e){}finally{var _data=this._data;this._domClasses(_data),this._synchronize()}},this._setupListeners=function(){var rootElement=document.body;rootElement.addEventListener("touchstart",function(e){UXHand._events.touchstart(e)}),rootElement.addEventListener("touchend",function(e){UXHand._events.touchend(e)}),rootElement.addEventListener("touchmove",function(e){UXHand._events.touchmove(e)})},this._events={touchstart:function(e){var dataObj=e.originalEvent;dataObj||(dataObj=e),UXHand._last.start=dataObj},touchend:function(e){var dataObj=e.originalEvent;dataObj||(dataObj=e),UXHand._last.end=dataObj.changedTouches,UXHand.cycle()},touchmove:function(e){UXHand._last.moved=!0,UXHand._last.drag.push(e)}},this._calc=function(){if(this._last){var _last=this._last;var output=[];var vectors=[{y:_last.start.touches[0].clientY,x:_last.start.touches[0].clientX},{y:_last.end[0].clientY,x:_last.end[0].clientX}];var drag=function(output){output.push(vectors[0].y>vectors[1].y?"up":vectors[0].y==vectors[1].y?"horizontal":"downw"),output.push(vectors[0].x<vectors[1].x?"right":vectors[0].x==vectors[1].x?"vertical":"left")};var tap=function(output){vectors[0].x<area.w?UXHand._data.scores.left++:vectors[0].x>area.w+area.x&&UXHand._data.scores.right++};var area=this.wireFrame.areas();if(_last.moved?(output.push("Move detected"),drag(output)):(output.push("Touch detected"),tap(output)),output.indexOf("vertical")>-1)vectors[0].x<area.w?this._data.scores.left++:vectors[0].x>area.w+area.x&&this._data.scores.right++;else{var measurePath={left:0,right:0};[].forEach.call(_last.drag,function(drag,index){var dragData=_last.drag[index].touches[0];var position={x:dragData.clientX,y:dragData.clientY};if(_last.drag[index+1]){var nextDragData=_last.drag[index+1].touches[0];var nextPosition={x:nextDragData.clientX,y:nextDragData.clientY};nextPosition.x>position.x&&nextPosition.y<position.y?measurePath.right++:nextPosition.x<position.x&&nextPosition.y<position.y?measurePath.left++:nextPosition.x>position.x&&nextPosition.y>position.y?measurePath.left++:nextPosition.x<position.x&&nextPosition.y>position.y&&measurePath.right++}}),measurePath.left>measurePath.right?UXHand._data.scores.left++:measurePath.right>measurePath.left&&UXHand._data.scores.right++}}},this._domClasses=function(_data){var update=function(value){var classes=value.split(",");var html=document.querySelector("html"),htmlCurrent=html.className.indexOf(" ")>-1?html.className.split(" "):[];var update=htmlCurrent;classes.forEach(function(name){update.push(name)}),html.className=update.join(" ")};var reset=function(){var html=document.querySelector("html"),htmlCurrent=html.className.split(" ");var inHouseClasses=["righthand","lefthand","bothhands"];inHouseClasses.forEach(function(inHouse){htmlCurrent.splice(inHouse,1)}),html.className=htmlCurrent};var count=_data.scores.left+_data.scores.right+_data.scores.both;if(document.getElementById("textfield")&&(document.getElementById("textfield").innerHTML=count),_data&&!(count<this.options().threshold)){_data.scores.left>_data.scores.right*(1+this.options().certainty)?(reset(),update("lefthand")):_data.scores.right>_data.scores.left*(1+this.options().certainty)&&(reset(),update("righthand"));var average=(_data.scores.right+_data.scores.left)/2;_data.scores.both>average&&update("bothhands")}},this.destroy=function(){localStorage.removeItem("UXHandData")},this.wireFrame=new function(){this.areas=function(){var gap=UXHand.options().certainty,x=screen.width*gap,w=screen.width/2-x/2;return{gap:gap,x:x,w:w}},this.errorGap=function(){var area=this.areas();return{x:[0,area.w+area.x]}},this.render=function(){var area=this.areas();var rendering=["<div ","style='","position:absolute;","top:0;","bottom:0;","left:",area.w,"px;","width:",area.x,"px;","background-color:rgba(0,0,0,0.2);","display:inline-block;","' />"];$("body").prepend(rendering.join("")),rendering=["<div class='lefthand'","style='","position:absolute;","bottom:0;","left:0;","width:",area.w,"px;","height:",.575*screen.height,"px;","background-color:#3F51B5;opacity:1;","' />"],$("body").prepend(rendering.join("")),rendering=["<div class='righthand'","style='","position:absolute;","bottom:0;","right:0;","width:",area.w,"px;","height:",.575*screen.height,"px;","background-color:#3F51B5;opacity:1;","' />"],$("body").prepend(rendering.join(""))}},this.version="0.2.2",this.init=function(){this.compatibility()&&this.touchTest()&&this._synchronize(function(){UXHand._setupListeners(),UXHand.cycle()})},this._data={scores:{left:null,right:null,both:null}},this._last={start:null,end:null,drag:[],moved:!1}};UXHand.init();