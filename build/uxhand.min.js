"use strict";var UXHand=new function(){this.isIOS=function(){return navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1},this._synchronize=function(callback){var localData=JSON.parse(localStorage.getItem("UXHandData"));null==this._data.scores.left&&null==this._data.scores.right&&null==this._data.scores.both&&localData?this._data=localData:localStorage.setItem("UXHandData",JSON.stringify(this._data)),callback&&callback()},this.compatibility=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},this.touchTest=function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}},this.options=function(){var userOptions=window.UXHandOptions;var output={certainty:.2,cycleDelay:2e4,destroyClasses:!0,destroyData:!0,root:document.body,threshold:50};if(userOptions)try{for(var key in userOptions)output[key]=userOptions[key]}catch(e){}return output},this.cycle=function(){try{this._calc()}catch(e){}finally{var _data=this._data;if(this._domClasses(_data),this._synchronize(),UXHand.HeatMap){var data=this._last;data.start&&0!=data.start.pageX&&0!=data.start.pageY&&this.tracking.push({x:data.start.pageX,y:data.start.pageY,pageX:data.start.pageX,pageY:data.start.pageY-window.pageYOffset,count:5}),data.end&&0!=data.end[0].clientY&&0!=data.end[0].clientX&&this.tracking.push({x:data.end[0].clientX,y:data.end[0].clientY,pageX:data.end[0].pageX,pageY:data.end[0].pageY-window.pageYOffset,count:5}),0!=data.drag.length&&[].forEach.call(data.drag,function(drag,index){UXHand.tracking.push({x:drag.x,y:drag.y,pageX:drag.pageX,pageY:drag.pageY-window.pageYOffset,count:5})})}this._last.move=!1,this._last.drag=[]}},this._setupListeners=function(){var rootElement=document.body;rootElement?(rootElement.addEventListener("touchstart",function(e){UXHand._events.touchstart(e)}),rootElement.addEventListener("touchend",function(e){UXHand._events.touchend(e)}),rootElement.addEventListener("touchmove",function(e){UXHand._events.touchmove(e)})):document.addEventListener("DOMContentLoaded",function(){UXHand._setupListeners()},!1)},this._events={touchstart:function(e){var dataObj=e;dataObj||(dataObj=e),UXHand._last.start=dataObj},touchend:function(e){var dataObj=e;dataObj||(dataObj=e),UXHand._last.end=dataObj.changedTouches,UXHand.cycle()},touchmove:function(e){UXHand._last.moved=!0,-1==UXHand._last.drag.indexOf(e)&&UXHand._last.drag.push({x:e.touches[0].clientY,y:e.touches[0].clientX,pageX:e.touches[0].pageX,pageY:e.touches[0].pageY-window.pageYOffset})}},this._calc=function(){if(this._last){var _last=this._last;var output=[];var vectors=[{y:_last.start.touches[0].clientY,x:_last.start.touches[0].clientX},{y:_last.end[0].clientY,x:_last.end[0].clientX}];var drag=function(output){output.push(vectors[0].y>vectors[1].y?"up":vectors[0].y==vectors[1].y?"horizontal":"down"),output.push(UXHand.isIOS()?vectors[0].x<vectors[1].x?"left":vectors[0].x==vectors[1].x?"vertical":"right":vectors[0].x<vectors[1].x?"right":vectors[0].x==vectors[1].x?"vertical":"left"),handSize(vectors[0],vectors[1])};var tap=function(output){vectors[0].x<area.w?UXHand._data.scores.left++:vectors[0].x>area.w+area.x&&UXHand._data.scores.right++};var handSize=function(){};var area=this.wireFrame.areas();if(_last.moved?(output.push("Move detected"),drag(output)):(output.push("Touch detected"),tap(output)),output.indexOf("vertical")>-1)vectors[0].x<area.w?this._data.scores.left++:vectors[0].x>area.w+area.x&&this._data.scores.right++;else{var measurePath={left:0,right:0};[].forEach.call(_last.drag,function(drag,index){var position=_last.drag[index];if(_last.drag[index+1]){var nextPosition=_last.drag[index+1];nextPosition.x>position.x&&nextPosition.y<position.y?measurePath.right++:nextPosition.x<position.x&&nextPosition.y<position.y?measurePath.left++:nextPosition.x>position.x&&nextPosition.y>position.y?measurePath.left++:nextPosition.x<position.x&&nextPosition.y>position.y&&measurePath.right++}}),measurePath.left>measurePath.right?UXHand._data.scores.left++:measurePath.right>measurePath.left&&UXHand._data.scores.right++}}},this._domClasses=function(_data){var update=function(value){var classes=value.split(","),UXHandClasses=["lefthand","righthand","bothhands"];var html=document.querySelector("html"),htmlClass=html.className;var outputClasses=function(){return UXHandClasses.forEach(function(className){value.indexOf(className)>=0?-1==htmlClass.indexOf(className)&&(htmlClass+=" "+className):htmlClass=htmlClass.replace(" "+className,"")}),htmlClass};html.className=outputClasses()};var count=_data.scores.left+_data.scores.right+_data.scores.both;if(document.getElementById("textfield")&&(document.getElementById("textfield").innerHTML=count),_data&&!(count<this.options().threshold)){_data.scores.left>_data.scores.right*(1+this.options().certainty)?update("lefthand"):_data.scores.right>_data.scores.left*(1+this.options().certainty)&&update("righthand");var average=(_data.scores.right+_data.scores.left)/2;_data.scores.both>average&&update("bothhands")}},this.destroy=function(){localStorage.removeItem("UXHandData")},this.version="0.2.6",this.init=function(){this.compatibility()&&this.touchTest()&&this._synchronize(function(){UXHand._setupListeners(),UXHand.cycle()})},this._data={scores:{left:null,right:null,both:null}},this._last={start:null,end:null,drag:[],moved:!1},this.tracking=[]};UXHand.init();